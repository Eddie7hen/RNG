<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>reg</title>
    <link rel="stylesheet" type="text/css" href="../css/base.css" />
    <link rel="stylesheet" type="text/css" href="../css/reg.css" />
    <script src="../js/common.js" type="text/javascript"></script>
    <script src="../lib/jQuery/jquery-3.2.1.js" type="text/javascript"></script>
</head>
<body>
    <header id="header"></header>
    <main id="reg">
        <div class="container">
            <div class="reg-box">
                <h3 class="reg-nav">账号登录</h3>
                <div class="ph-reg">
                    <ul>
                        <li>
                            <input type="text" name="loginName" class="regIpt" placeholder="手机号" id="account" />
                            <i class="iconfont icon-kefu"></i>
                        </li>
                        <li>
                            <input type="password" name="loginPswd" class="regIpt" placeholder="密码" id="password"/>
                            <i class="iconfont icon-kefu"></i>
                        </li>
                        <li class="clearfix">
                            <input type="text" name="loginCode" class="checkIpt" placeholder="验证码"/>
                            <span class="showCode">9T3A</span>
                        </li>
                        <li><input type="button" name="loginSubmit" class="btnIpt" value="登录"/></li>
                        <p class="notVip">不是会员：<a href="#">马上注册</a><a href="#" style="float:right;">忘记密码？</a></p>
                        <li><div class="output"></div></li>
                    </ul>
                </div>
            </div>
        </div>
    </main>
    <footer id="footer"></footer>
</body>
</html>
<script type="text/javascript">
(function($){
    var $account = $('#account');
    var $password = $('#password');
    var $checkipt = $('.checkIpt');
    var $showCode = $('.showCode');
    var $btnipt = $('.btnIpt');
    var $output = $('.output');

    //页面刷新时出现验证码
    $showCode.html(NumberAndAlphabet());

    //点击按钮输出结果
    $btnipt.on('click',function(){
        //获取val
        var acnt = $account.val();
        var pswd = $password.val();
        if(/^1[3,5,8]\d{9}$/.test(acnt) && /^[^\s]{6,}$/ && $checkipt.val() === $showCode.text()){
            $.ajax({
                type:'get',
                url:'../api/signIn.php',
                data:{'account':acnt,'pswd':pswd},
                dataType:'text',
                //回调函数获取值
                success:function(json){
                    var res = json;
                    console.log(res);
                    if(res==='no'){
                        $output.html(' ');
                        $account.val('').focus();
                        $password.val('');
                        $checkipt.val('');
                        $output.html('<strong style="color:red;">你输入的用户名或密码错误!</strong>')
                    }else if(res === 'yes'){
                        location.href ='http://www.baidu.com';
                    }
                },
                async:true,
            });
        }else{
            //清空页面
            $account.val('').focus();
            $password.val('');
            $checkipt.val('');
            //错误是刷新验证码
            $output.html(' ');
            $output.html('<strong style="color:red;">你输入的用户名或密码或验证码错误</strong>');
            $showCode.html(NumberAndAlphabet());
        }
    });


})(jQuery);
</script>